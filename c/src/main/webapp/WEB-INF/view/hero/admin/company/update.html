[#include "/core/head.html"/]
<div class="modal-header">
	<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	<h4 class="modal-title">修改公司信息</h4>
</div>

<div class="modal-control">
	<form action="" id="editForm">
		<div class="modal-body clearfix">
			<div class="form-body">
				<input type="hidden" id="id" name="id" value="${company.id}">
				<input type="hidden" name="token" value="${token}">
				<div class="form-group">
					<label class="col-sm-3 control-label">公司账号：</label>
					<div class="col-md-9">
						<input id="companyAccount" name="companyAccount" type="text" readonly="readonly" value="${company.companyAccount}" class="form-control"/>
					</div>
				</div>
				<div class="form-group">
					<label class="col-md-3 control-label">公司ip/地址：</label>
					<div class="col-md-9">
						<input id="address" name="address" type="text" value="${company.address}"
							class="form-control" placeholder="请输入公司ip或者地址！"
							required="required">
					</div>
				</div>
				<div class="form-group">
					<label class="col-md-3 control-label">公司名称：</label>
					<div class="col-md-9">
						<input id="companyName" name="companyName" type="text" value="${company.companyName}"
							class="form-control" placeholder="请输入公司名称" required="required">
					</div>
				</div>
				<div class="form-group">
					<label class="col-md-3 control-label">公司域名：</label>
					<div class="col-md-9">
						<input id="webSite" name="webSite" type="text" value="${company.webSite}"
							class="form-control" placeholder="请输入公司域名" required="required">
					</div>
				</div>
				<div class="form-group">
					<label class="col-md-3 control-label">电话号码：</label>
					<div class="col-md-9">
						<input id="telNum" name="telNum" type="text" value="${company.telNum}" class="form-control"
							placeholder="请输入正确的电话号码" required="required">
					</div>
				</div>
			</div>
		</div>
		<div class="modal-footer">
			<button type="button" class="btn default" data-dismiss="modal">关闭</button>
			<button type="button" id="editSub" class="btn blue">提交</button>
			<input type="reset" style="display:none;" /> 
		</div>
	</form>
</div>
<script type="text/javascript">
$("#editForm").validate({
	rules:{
		address:{
			required:true
		},
		companyName:{
			required:true,
			minlength:3,
			maxlength:15
		},
		webSite:{
			required:true,
			url:true
		},
		telNum:{
			required:true,
			phone:true
		}
	},
	messages:{
		address:{
			required:"请输入公司ip或者地址"
		},
		companyName:{
			required:"请输入公司名称,长度3-15个字符",
			minlength:"至少3个字符",
			maxlength:"最多15个字符"
		},
		webSite:{
			required:"请输入公司域名",
			url:"请输入合法的域名"
		},
		telNum:{
			required:"请输入电话号码",
			phone:"请输入正确的电话号码"
		}
	}
})
$("#editSub").on("click", function(){
	if (! $("#editForm").valid()) {
        return;
     }
	$.ajax({
		url : "${ctx}/oc/company/edit",
		type : "POST",
		data : $("#editForm").serialize(),
		success : function(data) {
			if (data.errors != undefined) {
				var error = data.errors;
				layer.alert(error[0].field + ":" + error[0].message);
				return;
			} else if(data.code != undefined){
				layer.alert(data.msg);
				if(data.code){
					$("#ajax-modal-large").modal("hide");
				}
				table.api().ajax.reload();
			} else {
				layer.alert("登录已超时！");
				window.location.href = "${ctx}/";
			}
		}
	});
})
/* $("#editForm").on("submit", function(ev){
	ev.preventDefault();
	if (! $("#editForm").valid()) {
        return;
     }
	$.ajax({
		url : "${ctx}/oc/company/edit",
		type : "POST",
		data : $("#editForm").serialize(),
		success : function(data) {
			if (data.errors != undefined) {
				var error = data.errors;
				layer.alert(error[0].field + ":" + error[0].message);
				return;
			} else if(data.code != undefined){
				layer.alert(data.msg);
				if(data.code){
					$("#ajax-modal-large").modal("hide");
				}
				table.api().ajax.reload();
			} else {
				layer.alert("登录已超时！");
				window.location.href = "${ctx}/";
			}
		}
	});
}) */
</script>